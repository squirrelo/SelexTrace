from bayeswrapper import bayesfold
from StringIO import StringIO

fastaseqs = {"MISEQ:8:000000000-A18AY:1:1101:12274:26426_11":
"GACUUCGGUCCAAGCUAAUGCACUCUGAUGAUCGCGUGGAUAUGGUACACAUUGAAUUGUUGGACACCGUAAAUGUCCUAACACGGGGGCAU",
"MISEQ:8:000000000-A18AY:1:1101:14188:4443_26":
"GACUUCGGUCCAAGCUAAUGCACUCUGAUGAUCGCGUGGAUAUGGCGCGCAUUGAAUUGUUGGGCACCGUAAAUGUCCUAACACGGGGGCAU",
"MISEQ:8:000000000-A18AY:1:1101:22090:7020_90":
"GACUUCGGUCCAAGCUAAUGCACUCUGAUGAUCGCGUGGAUAUGGUACGCAUUGAAUUGUUGGGCACCGUAAAUGUCCUAACACGGGGGCAU",
"MISEQ:8:000000000-A18AY:1:1102:15083:7079_17":
"GACUUCGGUCCAAGCUAAUGCACUCUGAUGAUCGCAUGGAUAUGGUACGCAUUGAAUUGUUGGGCACCGUAAAUGUCCUAACACGGGCGCAU",
"MISEQ:8:000000000-A18AY:1:1102:18612:5535_7":
"GACUUCGGUCCAAGCUAAUGCACUCUGAUGAUCGCGUGGAUAUGGUACGCAUUGAAUUGUUGGGCACCGUAAAUGCCCUAACACGGGGGCAU",
"MISEQ:8:000000000-A18AY:1:1102:26024:20405_4":
"GACUUCGGUCCAAGCUAAUGCACUCUGAUGAUCGCGUGGAUAUGGCCCGCAUUGAAUUGUUGGGCACCGUAAAUGUCCUAACACGGGGGCAU",
"MISEQ:8:000000000-A18AY:1:1105:14627:21327_3":
"GACUUCGGUCCAAGCUAAUGCACUCUGAUGAUCGCAUGGAUAUGGUACGCAUUGAAUUGUUGGGCACCGUAAAUGCCCUAACACGGGCGCAU",
"MISEQ:8:000000000-A18AY:1:1105:9939:17358_2":
"GACUUCGGUCCAAGCUAAUGCACUCUGAUGAUCGCAUGGAUAUGGUACGCAUUGAAUUGUUGGGCACCGUAAAUGUCCUAACACGGGCACAU",
"MISEQ:8:000000000-A18AY:1:1106:17400:6900_2":
"GACUUCGGUCCAAGCUAAUGCACUCUGAUGAUCGAGUGGAUAUGGUACGCAUUGAAUUGUUGGGCACCGUAAAUGUCCUAACACGGGGGCAU",
"MISEQ:8:000000000-A18AY:1:1107:2414:17210_2":
"GACUUCGGUCCAAGCUAAUGCACUCUGAUGAGCGCGUGGAUAUGGUACGCAUUGAAUUGUUGGACACCGUAAAUGUCCUAACACGGGGGCAU",
"MISEQ:8:000000000-A18AY:1:1107:29080:16480_2":
"GACUUCGGUCCAAGCUAAUGCACUCUGAUGAUCGCGUGGAUAUGGUACGCAUUGAAUUGUUGGGCACCGUAAAUGUCCUAACACGGGGGCAA",
"MISEQ:8:000000000-A18AY:1:1110:11594:5021_2":
"GACUUCGGUCCAAGCUAAUGCACUCUGAUGAUCGCGUGGAUAUGGUACGCAUUGAAUUGUUGGGCACCGUAAAUGUCCUAACCCGGGGGCAU"}

if __name__ == "__main__":
    aln, struct = bayesfold(fastaseqs)
    print struct
    print aln
    if struct != ".....((((((..((((((((...((....(((.....)))..))...))))))....))..)).))))....((((((......)))))).":
        print "FAIL!"
    else:
        print "PASS!"

